---
title: "MySQL DML"
date: 2025-09-24 10:00:00 +0800
categories: [CS basics, Mysql] # [Top_category, sub_category]
tags: [sql]      # TAG names should always be lowercase
# author:gaoshan
---

```sql
mysql -u账号 -p密码 # 明文登录
mysql -u 账号 -p   # 暗文登录
密码
```
```sh
-- 远程登录
mysql --host=localhost 或者 127.0.0.1
--user=账号 --password=密码

# 前提: 配置好path变量; 而linux和mac则是在 vim /etc/profile 中
# 配置path的目的是: 可以在任何的路径下, 使用配置path后的路径
# 系统变量下,只要是这台电脑,无论哪个账号都能用. 而用户变量...
export MySQL=...
export ...
:wq
```
约束constraints
单表约束:主键约束primary key结合 auto_increment(自增)

# Part 2 
```sql
/* --- 单表约束: 
            主键primary key, 一般结合自增auto_incremnt) 特点:非空,唯一; 一般是数字列 
            非空约束: not null
            唯一约束: unique
            默认约束: default, 不给值则用默认值填充
        多表约束: 
            多表约束:foreign key 
*/
-- 1.建库, 切库, 查表.
drop database if exists day02;
create database day02;
use day02;
show tables;

-- 2. 创建学生表, 字段(id, name, gender, age)
create table student(
    id int primary key, # 学生id, 主键(非空, 唯一)
    name varchar(20),
    gender varchar(10),
    age int
);

-- 3. 给学生表添加数据.
insert into student values(1, ‘美杜莎‘, ’女‘, 23);
insert into student values(2, ‘林说‘, ’男‘, 22);
insert into student values(2, ‘杜莎‘, ’女‘, 23); -- error,主键冲突(唯一性)
insert into student values(null, ‘美莎‘, ’女‘, 24);-- error,主键冲突(非空性); 若加了自增则不会报错,id会在赋值时自动加1(最大id的基础上,哪怕中途有id被删了,也如此).

-- 4. 查看学生表结构 和 数据
desc student; -- 查看表结构
select * from student;

# ---------------- delete from 和 truncate table的区别-----------------
/* 
区别: 
    1. delete from 只删除表数据, 不回重置主键id.
     truncate table相当于把表摧毁了, 然后创建一张表和该表一模一样的新表, 即: **会重置主键id**
    2.delete from 属于DML语句, 可结合 事务 一起使用.
    truncate table 属于DDL语句.
*/

-- 1. 查看表数据
select * from student;

-- 2. delete from删除
delete from student;

-- 3. truncate from
truncate table student;
truncate student; # 可不写table关键字

-- 4. 插入数据
insert into student values(null, ‘杜莎了’, ‘女’, 21);


# ---------------- 约束详解 常用的单表约束 -----------------
 
-- 1.建库, 切库, 查表.
drop database if exists day02;
create database day02;
use day02;
show tables;

-- 2. 建老师表, 字段(id primary key, name not null, phone unique, addr default)
create table teacher(
    id int primary key auto_increment,
    name varchar(20) not null,
    phone varchar(11) unique,
    address varchar(30) default 'beijing'     # 
);

-- 3. 给学生表添加数据.
insert into teacher values(1, '美杜莎', '1231324343', 'beijing');
insert into teacher values(2, '林说', '232323232', 'xinxiang');
insert into teacher values(null, '杜莎', '232332423'); -- error: 不会自动填充北京,列数不匹配
insert into teacher(name) values('杜莎'); # oK

-- 4. 查看teacher表结构 和 数据
desc teacher; -- 查看表结构
select * from teacher;


# ---------------- 备份表数据 -----------------
-- 0. 查看所有的数据表.
show tables;

-- 1. 查看源表数据.
select * from teacher;

-- 2. 备份表数据, 只会备份: 表数据, 列名, 数据类型, 不会备份约束(约束本质上是索引).
-- 场景1: 备份表, 不存在
-- 格式: create table 备份表名 select * from 源表名 where 条件...;
create table teacher_tmp
    select * from teacher;

-- 场景2: 备份表, 存在.
-- 格式: insert into 备份表名 select * from 源表名 where 条件...;
truncate teacher_tmp; --数据丢失, 表还在

insert into teacher_tmp
    select * from teacher;

-- 3. 查看备份表的数据.
select * from teacher_tmp;

-- 4. 模拟紧急情况下的“数据恢复”

-- 5. 查看表数据的约束
desc teacher;       -- 源表
desc teacher_tmp;   -- 备份表

```

DQL语句-单表、多表

窗口函数

