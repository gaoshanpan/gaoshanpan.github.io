---
title: "Shell"
date: 2025-10-22 10:00:00 +0800
categories: [CS basics, Shell] # [Top_category, sub_category]
tags: [shell]      # TAG names should always be lowercase
# author:gaoshan
# add image: ![img-description](/assets/img/os.jpg)
---

Linux shell 指的是接收用户命令并将其解析为操作系统可执行指令的接口/解释程序。shell 主要分为两种类型：命令行界面（CLI）和图形用户界面（GUI）。
Shell 主要分为两大类：命令行 Shell 和图形化 Shell。

简单概括: ​​Shell（壳）是一个程序，它接收你输入的命令，然后把这些命令“翻译”给计算机的操作系统内核去执行。​​ 它是用户（你）和操作系统内核（计算机的核心）之间的一个接口。

Linux 是一款自 1990 年代中期问世的操作系统，在从小型企业到大型公司的各类组织中广受欢迎。其广泛应用的关键原因之一在于 Linux 壳层——这款强大的工具让用户能够执行从简单文件管理到复杂系统管理任务的各种操作。

什么是Shell？
在计算机领域，shell作为用户与操作系统之间的接口程序，通过接收用户输入的命令并将其转换为操作系统可识别的指令，从而建立操作系统与人类用户之间的连接。
本质上，Shell是解析用户输入命令并将其传递给操作系统的解释程序。早期系统仅提供命令行界面（CLI），而如今已出现多种图形用户界面（GUI）/图形化Shell。

![img-description](/assets/img/shell.jpg)

为什么 Shell（特别是命令行）如此重要？
尽管图形界面很友好，但命令行 Shell 在以下方面无可替代：
**​​自动化​**​：你可以将一系列命令写在一个脚本文件（如 .sh或 .bat文件）中，然后一键运行，自动完成复杂的任务（例如，自动备份文件、批量重命名文件、部署网站等）。
如: 想要再凌晨自动备份一个日志、或者是定时清理一些日志文件等等

​​高效精准​​：对于有经验的用户，用键盘输入命令通常比在图形界面中多次点击更快、更直接。
​​远程管理​​：通过 SSH 等协议，命令行可以轻松地管理和控制远在千里之外的服务器，只需要极低的网络带宽。
​​强大的工具链​​：许多强大的开发工具、系统工具只提供命令行接口。

## 
```bash
vim hello.sh
```
-- press i to insert mode

每一一个shell脚本的头行first line都需要有:

#!/bin/bash    -- linux中用的最多的就是bash

#!/bin/zsh

..具体根据shell的类型bash、zsh、fish去写. 这样系统就会知道去调用bash(或zsh看头行写的是什么)去解释执行这个脚本

```sh
#!/bin/bash
echo “Hello Shell”
date
whoami
```

```bash
# 执行之前要加上执行权限
chmod a+x hello.sh
./hello.sh
# 若用sh 则有只读权限也能看, 区别是?
bash hello.sh
```

注意的点: 关于环境变量

name=gaoshan 直接赋值在命令行: 只在当前shell会话(session)中有效, 不能在脚本文件中引用这些变量, 且每次关闭命令行, 变量消失. 

### 让环境变量永久有效(注意不同shell的配置文件可能有差异)
export name=gaoshan 可以通过 export 把变量转变为环境变量  
.bashrc() 和 .profile(这里是打开shell会话时执行一次)
source .


## 具体语法在去查看学习
略

### 问题: 下面的脚本，在Linux上运行良好，在SUNOS执行的时候报语法错误。
 
bash game.sh 和 sh game.sh 不一定一样，具体取决于脚本文件的开头定义和系统默认的 sh 命令。 bash 命令明确地使用 Bash Shell 来执行脚本，而 sh 命令会使用系统默认的POSIX Shell，它可能是一个链接到Bash 或者其他Shell（例如Dash），因此可能会有不同的行为，尤其是在执行错误时。

```sh
#! /bin/sh

#支持fwu的使用fwu 不支持的使用fu
PS_TYPE="ps -fwu"
do_ps=`ps -fwu 2>/dev/null`
if [ "$?" -eq 1 ]
then
	PS_TYPE="ps -fu"
fi

OSTYPE=`uname -a | awk '{print substr($0,1,3)}'`
SELF_PATH=$(cd `dirname $0`; pwd)
#SELF_PATH=`dirname $0`
SELF_NAME=`basename $0`
```
其实就是获取脚本的当前文件路径。

同样的一段shell脚本，在 Linux主机上运行良好， 但是在SUNOS上 却执行报错了

```sh
syntax error at line 12: `SELF_PATH=$' unexpected
```

查看主机的SHELL解释器类型, 发现是是脚本解释器的问题.

```sh
ocsdb02:[/oracle$]echo $SHELL
/bin/bash
ocsdb02:[/oracle$]
```
将 第一行的 #! /bin/sh 调整为 #！/bin/bash ，重新执行OK了。

事实上 SUOS主机上的sh的软连接的配置：
```sh
ll /bin/sh

lrwx.....  /bin/sh --> ../sbin/sh
```

LINUX主机上的 sh的软连接配置 （sh一般设成bash的软链,软连接类似于快捷键）
```sh
ll /bin/sh

lrwx.....  /bin/sh --> bash
```
所以才会在Linux上运行OK，在sunos上执行语法错误, sh解释器不支持bash下的一些操作.

**第二种方法** 是修改主机的默认SHELL，即修改软连接为BASH。


Bash is an sh-compatible command language interpreter that executes commands read from the standard input or from a file. Bash also incorporates useful features from the Korn and C shells (ksh and csh).

Linux中的shell有多种类型，其中最常用的几种是Bourne shell（sh）、C shell（csh）和Korn shell（ksh）。

Bourne shell在shell编程方面相当优秀，但在处理与用户的交互方面做得不如其他几种shell。

Linux操作系统缺省的shell是Bourne Again shell，它是Bourne shell的扩展，简称Bash，与Bourne shell完全向后兼容，并且在Bourne shell的基础上增加、增强了很多特性。Bash放在/bin/bash中，它有许多特色，可以提供如命令补全、命令编辑和命令历史表等功能，它还包含了很多C shell和Korn shell中的优点，有灵活和强大的编程接口，同时又有很友好的用户界面。

GNU/Linux 操作系统中的 /bin/sh 是 bash（Bourne-Again Shell）的符号链接，但鉴于 bash 过于复杂，有人把 ash 从 NetBSD 移植到 Linux 并更名为 dash（Debian Almquist Shell） https://wiki.ubuntu.com/DashAsBinSh ，并建议将 /bin/sh 指向它，以获得更快的脚本执行速度。

What you should use when writing scripts

If your script requires features only supported by bash, use #!/bin/bash.

But if at all possible, it would be good to make sure your script is POSIX-compatible, and use #!/bin/sh, which should always, quite reliably, point to the preferred POSIX-compatible system shell in any installation.